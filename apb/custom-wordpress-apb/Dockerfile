FROM openshift3/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGN1c3RvbS13b3JkcHJlc3MtYXBiCmRlc2NyaXB0aW9uOiBUaGlz\
IHNlcnZpY2Ugd2lsbCBkZXBsb3kgYSBmdWxseSBjdXN0b21pemVkIGFuZCByZWFkeSB0byB1c2Ug\
V29yZHByZXNzIHNpdGUuCmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0aW9uYWwKbWV0YWRhdGE6\
CiAgZGlzcGxheU5hbWU6IEN1c3RvbSBXb3JkcHJlc3MgU2VydmljZQogIHByb3ZpZGVyRGlzcGxh\
eU5hbWU6ICJBQ01FLCBJbmMuIgogIGRvY3VtZW50YXRpb25Vcmw6ICJodHRwczovL3d3dy53b3Jk\
cHJlc3Mub3JnLyIgCiAgY29uc29sZS5vcGVuc2hpZnQuaW8vaWNvbkNsYXNzOiBpY29uLXdvcmRw\
cmVzcwpwbGFuczoKICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBEZWZhdWx0IHBs\
YW4KICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiB7fQogICAgcGFyYW1ldGVyczoKICAgICAg\
LSBuYW1lOiBleHRlcm5hbF9ob3N0bmFtZQogICAgICAgIHRpdGxlOiBFeHRlcm5hbCBob3N0bmFt\
ZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIGRlZmF1bHQ6IHd3dy5vcGVuc2hpZnQtYW53\
ZW5kZXIuZGUKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIGRpc3BsYXlfZ3JvdXA6ICJC\
YXNpYyBzZXR0aW5ncyIKICAgICAgLSBuYW1lOiBvY3BfYXBwX25hbWUKICAgICAgICB0aXRsZTog\
QXBwbGljYXRpb24gSUQKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkZWZhdWx0OiBvcGVu\
c2hpZnQtYW53ZW5kZXIKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIGRpc3BsYXlfZ3Jv\
dXA6ICJCYXNpYyBzZXR0aW5ncyIKICAgICAgLSBuYW1lOiB3cF9ibG9nX3RpdGxlCiAgICAgICAg\
dGl0bGU6IEJsb2cgdGl0bGUKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkZWZhdWx0OiBv\
cGVuc2hpZnQtYW53ZW5kZXIKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIGRpc3BsYXlf\
Z3JvdXA6ICJXb3JkcHJlc3Mgc2V0dGluZ3MiCiAgICAgIC0gbmFtZTogd3Bfb3B0aW9uc19ibG9n\
ZGVzY3JpcHRpb24KICAgICAgICB0aXRsZTogQmxvZyBkZXNjcmlwdGlvbgogICAgICAgIHR5cGU6\
IHN0cmluZwogICAgICAgIGRpc3BsYXlfdHlwZTogdGV4dGFyZWEKICAgICAgICBkZWZhdWx0OiAi\
RGllIENvbW11bml0eSBTZWl0ZSBmw7xyIGFsbGUgQW53ZW5kZXIgJiBJbnRlcmVzc2llcnRlIGRl\
ciBSZWQgSGF0IE9wZW5TaGlmdCBDb250YWluZXIgUGxhdHRmb3JtIgogICAgICAgIHJlcXVpcmVk\
OiBUcnVlCiAgICAgICAgZGlzcGxheV9ncm91cDogIldvcmRwcmVzcyBzZXR0aW5ncyIKICAgICAg\
LSBuYW1lOiB3cF9hZG1pbl91c2VyCiAgICAgICAgdGl0bGU6IEFkbWluIHVzZXIKICAgICAgICB0\
eXBlOiBzdHJpbmcKICAgICAgICBkZWZhdWx0OiBhZG1pbgogICAgICAgIHJlcXVpcmVkOiBUcnVl\
CiAgICAgICAgZGlzcGxheV9ncm91cDogIldvcmRwcmVzcyBzZXR0aW5ncyIKICAgICAgLSBuYW1l\
OiB3cF9hZG1pbl9lbWFpbAogICAgICAgIHRpdGxlOiBBZG1pbiBlLW1haWwKICAgICAgICB0eXBl\
OiBzdHJpbmcKICAgICAgICBkZWZhdWx0OiBzZWJhc3RpYW4uZmF1bGhhYmVyQHJlZGhhdC5jb20K\
ICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIGRpc3BsYXlfZ3JvdXA6ICJXb3JkcHJlc3Mg\
c2V0dGluZ3MiICAgICAgICAgICAgICAgIAogICAgICAtIG5hbWU6IHdwX29wdGlvbnNfdGltZXpv\
bmUKICAgICAgICB0aXRsZTogVGltZXpvbmUKICAgICAgICB0eXBlOiBlbnVtCiAgICAgICAgZW51\
bTogWyJFdXJvcGUvQmVybGluIiwgIkV1cm9wZS9Mb25kb24iLCAiVVRDIl0KICAgICAgICBkZWZh\
dWx0OiAiRXVyb3BlL0JlcmxpbiIKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIGRpc3Bs\
YXlfZ3JvdXA6ICJXb3JkcHJlc3Mgc2V0dGluZ3Mi"



COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
